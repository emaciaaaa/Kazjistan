<!DOCTYPE html>
<html>
<head>
  <title>Election Results</title>
  <style>
    /* Add your styling here */
    .elected { background-color: #ddffdd; }
    .eliminated { background-color: #ffdddd; }
  </style>
</head>
<body>
  <h1>STV Election Results</h1>
  <div id="results"></div>
  <button id="calculate">Calculate Results</button>
  
  <script>
    function displayResults(data) {
      const container = document.getElementById('results');
      container.innerHTML = `
        <h2>Quota: ${data.quota}</h2>
        <h3>Elected Candidates:</h3>
        <ul>
          ${data.elected.map(c => `<li>${c.candidate} (${c.votes} votes)</li>`).join('')}
        </ul>
      `;
    }
    
    document.getElementById('calculate').addEventListener('click', () => {
      google.script.run
        .withSuccessHandler(displayResults)
        .withFailureHandler(error => {
          console.error(error);
          alert('Error calculating results');
        })
        .fullSTVCalculation();
    });
  </script>
</body>
</html>
