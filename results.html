<!DOCTYPE html>
<html>
<head>
  <title>Election Results</title>
  <style>
    body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }
    h1 { color: #0066cc; }
    .result { display: flex; margin: 10px 0; padding: 10px; background: #f5f5f5; }
    .candidate { flex: 2; font-weight: bold; }
    .votes { flex: 1; text-align: right; }
    .elected { background: #d4edda; border-left: 4px solid #28a745; }
    .quota { margin-top: 20px; padding: 10px; background: #e2e3e5; }
  </style>
</head>
<body>
  <h1>Parliamentary Election Results</h1>
  <div id="results"></div>
  <div id="quota" class="quota"></div>
  <button id="refresh">Refresh Results</button>
  
  <script>
    function displayResults(results, quota) {
      const container = document.getElementById('results');
      container.innerHTML = '';
      
      results.forEach(result => {
        const div = document.createElement('div');
        div.className = `result ${result.elected ? 'elected' : ''}`;
        div.innerHTML = `
          <div class="candidate">${result.candidate}</div>
          <div class="votes">${result.votes} votes</div>
          ${result.elected ? '<div class="status">âœ“ ELECTED</div>' : ''}
        `;
        container.appendChild(div);
      });
      
      document.getElementById('quota').textContent = `Quota for election: ${quota} votes`;
    }
    
    function loadResults() {
      google.script.run
        .withSuccessHandler(data => {
          const quota = Math.floor(data.totalVotes / (data.results.length + 1)) + 1;
          displayResults(data.results, quota);
        })
        .withFailureHandler(error => {
          console.error(error);
          alert('Error loading results');
        })
        .getSTVResults();
    }
    
    document.getElementById('refresh').addEventListener('click', loadResults);
    window.addEventListener('load', loadResults);
  </script>
</body>
</html>
